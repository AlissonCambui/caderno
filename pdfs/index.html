<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Biblioteca Jurídica Digital - Alisson Cambui</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide (ícones) - Carregado no head com defer -->
    <script src="https://unpkg.com/lucide@latest/dist/lucide.min.js" defer></script>
    <style>
        :root { color-scheme: light; }
        html.dark { color-scheme: dark; }
        body { font-family: 'Inter', sans-serif; }
        ::-webkit-scrollbar { width: 12px; height: 12px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background-color: #94a3b8; border-radius: 20px; border: 3px solid #f1f5f9; }
        html.dark ::-webkit-scrollbar-track { background: #1e293b; }
        html.dark ::-webkit-scrollbar-thumb { background-color: #475569; border: 3px solid #1e293b; }
    </style>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'] }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-300">

    <!-- Overlay para menu mobile -->
    <div id="menu-overlay" class="fixed inset-0 bg-black/50 z-30 hidden" aria-hidden="true"></div>

    <!-- Barra Lateral de Navegação -->
    <aside id="sidebar" class="fixed inset-y-0 left-0 w-64 bg-white dark:bg-gray-800 shadow-lg z-40 transform -translate-x-full md:translate-x-0 transition-transform duration-300 ease-in-out" aria-label="Navegação principal">
        <div class="p-5 border-b border-gray-200 dark:border-gray-700">
            <h1 class="text-xl font-bold text-blue-600 dark:text-blue-400 flex items-center gap-2">
                <i data-lucide="library"></i>
                Biblioteca Jurídica
            </h1>
        </div>
        <nav class="p-4 space-y-2">
            <!-- Use data-page para navegação -->
            <a href="#" data-page="home" class="nav-link flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                <i data-lucide="home" class="w-5 h-5"></i><span>Início</span>
            </a>
            <a href="#" data-page="constitucional" class="nav-link flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                <i data-lucide="scale" class="w-5 h-5"></i><span>Constitucional</span>
            </a>
            <a href="#" data-page="civil" class="nav-link flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                <i data-lucide="users" class="w-5 h-5"></i><span>Civil</span>
            </a>
            <a href="#" data-page="penal" class="nav-link flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                <i data-lucide="gavel" class="w-5 h-5"></i><span>Penal</span>
            </a>
            <a href="#" data-page="trabalhista" class="nav-link flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                <i data-lucide="briefcase" class="w-5 h-5"></i><span>Trabalhista</span>
            </a>
            <a href="#" data-page="administrativo" class="nav-link flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                <i data-lucide="building" class="w-5 h-5"></i><span>Administrativo</span>
            </a>
            <a href="#" data-page="tributario" class="nav-link flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                <i data-lucide="landmark" class="w-5 h-5"></i><span>Tributário</span>
            </a>
            <a href="#" data-page="internacional" class="nav-link flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                <i data-lucide="globe" class="w-5 h-5"></i><span>Internacional</span>
            </a>
            <a href="#" data-page="empresarial" class="nav-link flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                <i data-lucide="store" class="w-5 h-5"></i><span>Empresarial</span>
            </a>
            <a href="#" data-page="ambiental" class="nav-link flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                <i data-lucide="leaf" class="w-5 h-5"></i><span>Ambiental</span>
            </a>
        </nav>
    </aside>

    <!-- Conteúdo Principal -->
    <main class="md:ml-64 p-4 md:p-8 min-h-screen">
        <header class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
            <div class="flex items-center gap-4 w-full md:w-auto">
                <button id="menu-toggle" aria-label="Abrir menu" class="md:hidden p-2 rounded-lg bg-white dark:bg-gray-800 shadow-md">
                    <i data-lucide="menu" class="w-6 h-6"></i>
                </button>
                <h2 class="text-xl font-semibold">Alisson Cambui — Biblioteca Jurídica</h2>
            </div>

            <div class="flex items-center gap-3 w-full md:w-auto">
                <div class="relative w-full md:w-64">
                    <input type="search" id="search-bar" placeholder="Buscar em todos os arquivos..." class="w-full pl-10 pr-4 py-2 rounded-lg bg-white dark:bg-gray-800 shadow-md focus:outline-none focus:ring-2 focus:ring-blue-500" />
                    <i data-lucide="search" class="w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                </div>
                <button id="dark-mode-toggle" class="p-2 rounded-lg bg-white dark:bg-gray-800 shadow-md" aria-pressed="false" aria-label="Alternar modo escuro">
                    <i data-lucide="moon" class="w-6 h-6 hidden dark:block"></i>
                    <i data-lucide="sun" class="w-6 h-6 block dark:hidden"></i>
                </button>
            </div>
        </header>

        <div id="content-area">
            <section id="page-home" class="page-content">
                <h3 class="text-2xl font-semibold mb-6">Áreas do Direito</h3>
                <div id="home-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </section>

            <!-- Seções por matéria -->
            <section id="page-constitucional" class="page-content hidden">
                <h3 class="text-2xl font-semibold mb-6">Direito Constitucional</h3>
                <div id="pdf-list-constitucional" class="pdf-list grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
            </section>
            <section id="page-civil" class="page-content hidden">
                <h3 class="text-2xl font-semibold mb-6">Direito Civil</h3>
                <div id="pdf-list-civil" class="pdf-list grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
            </section>
            <section id="page-penal" class="page-content hidden">
                <h3 class="text-2xl font-semibold mb-6">Direito Penal</h3>
                <div id="pdf-list-penal" class="pdf-list grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
            </section>
            <section id="page-trabalhista" class="page-content hidden">
                <h3 class="text-2xl font-semibold mb-6">Direito Trabalhista</h3>
                <div id="pdf-list-trabalhista" class="pdf-list grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
            </section>
            <section id="page-administrativo" class="page-content hidden">
                <h3 class="text-2xl font-semibold mb-6">Direito Administrativo</h3>
                <div id="pdf-list-administrativo" class="pdf-list grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
            </section>
            <section id="page-tributario" class="page-content hidden">
                <h3 class="text-2xl font-semibold mb-6">Direito Tributário</h3>
                <div id="pdf-list-tributario" class="pdf-list grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
            </section>
            <section id="page-internacional" class="page-content hidden">
                <h3 class="text-2xl font-semibold mb-6">Direito Internacional</h3>
                <div id="pdf-list-internacional" class="pdf-list grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
            </section>
            <section id="page-empresarial" class="page-content hidden">
                <h3 class="text-2xl font-semibold mb-6">Direito Empresarial</h3>
                <div id="pdf-list-empresarial" class="pdf-list grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
            </section>
            <section id="page-ambiental" class="page-content hidden">
                <h3 class="text-2xl font-semibold mb-6">Direito Ambiental</h3>
                <div id="pdf-list-ambiental" class="pdf-list grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
            </section>

            <section id="page-search-results" class="page-content hidden">
                <h3 class="text-2xl font-semibold mb-6">Resultados da Busca</h3>
                <div id="search-results-list" class="pdf-list grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
            </section>
        </div>
    </main>

    <!-- ALTERAÇÃO: Modal do Visualizador de PDF foi removido -->

    <!-- Script Principal da Aplicação -->
    <script>
    /*******************************
     * DADOS DA BIBLIOTECA
     * Esta seção contém os dados dos arquivos PDF.
     * Os caminhos (filePath) assumem que os PDFs estão
     * no mesmo diretório do arquivo index.html.
     *******************************/
    const libraryData = {
        'constitucional': {
            icon: 'scale', title: 'Constitucional',
            files: [
                // Adicione seus arquivos de Constitucional aqui
                // { title: 'Manual de Direito Constitucional', filePath: 'pdfs/constitucional/manual_const.pdf' },
            ]
        },
        'civil': {
            icon: 'users', title: 'Civil',
            files: [
                // Arquivos de Direito Civil atualizados
                { title: 'Bens Fungíveis e Infungíveis', filePath: 'bens fungiveis e infungiveis.pdf' },
                { title: 'Cessação da Incapacidade e Extinção da Personalidade', filePath: 'cessação da incapacidade-extinção da personalidade da pessoa natural.pdf' },
                { title: 'Classificação dos Bens', filePath: 'classificação dos bens.pdf' },
                { title: 'Da Pessoa Jurídica', filePath: 'da pessoa juridica.pdf' },
                { title: 'Domicílio da Pessoa Natural', filePath: 'domicilio da pessoa natural.pdf' },
                { title: 'Dos Bens', filePath: 'dos bens.pdf' },
                { title: 'Noções do Direito Civil', filePath: 'nocoes do direito civil.pdf' },
                { title: 'Personalidade Jurídica', filePath: 'personalidade juridica.pdf' }
            ]
        },
        'penal': {
            icon: 'gavel', title: 'Penal',
            files: [
                // Adicione seus arquivos de Penal aqui
                // { title: 'Teoria Geral do Crime', filePath: 'pdfs/penal/teoria_crime.pdf' },
            ]
        },
        'trabalhista': {
            icon: 'briefcase', title: 'Trabalhista',
            files: [
                // Adicione seus arquivos de Trabalhista aqui
                // { title: 'CLT Atualizada', filePath: 'pdfs/trabalhista/clt.pdf' },
            ]
        },
        'administrativo': {
            icon: 'building', title: 'Administrativo',
            files: [
                // Adicione seus arquivos de Administrativo aqui
                // { title: 'Manual de Direito Administrativo', filePath: 'pdfs/administrativo/manual_adm.pdf' },
            ]
        },
        'tributario': {
            icon: 'landmark', title: 'Tributário',
            files: [
                // Adicione seus arquivos de Tributário aqui
                // { title: 'Sistema Tributário Nacional', filePath: 'pdfs/tributario/sistema_tributario.pdf' }
            ]
        },
        'internacional': {
            icon: 'globe', title: 'Internacional',
            files: [
                // Adicione seus arquivos de Internacional aqui
                // { title: 'Direito Internacional Público', filePath: 'pdfs/internacional/dip.pdf' }
            ]
        },
        'empresarial': {
            icon: 'store', title: 'Empresarial',
            files: [
                // Adicione seus arquivos de Empresarial aqui
                // { title: 'Teoria Geral da Empresa', filePath: 'pdfs/empresarial/teoria_empresa.pdf' }
            ]
        },
        'ambiental': {
            icon: 'leaf', title: 'Ambiental',
            files: [
                // Adicione seus arquivos de Ambiental aqui
                // { title: 'Política Nacional do Meio Ambiente', filePath: 'pdfs/ambiental/politica_ambiental.pdf' }
            ]
        }
    };

    /*******************************
     * LÓGICA DA APLICAÇÃO
     *******************************/
    
    // Espera o DOM estar pronto para executar os scripts
    window.addEventListener('DOMContentLoaded', () => {
        // Inicializa todas as funções principais
        initDarkMode();
        populateHomePage();
        populatePdfLists();
        setupEventListeners();
        showPage('home'); // Mostra a página inicial
        
        // Garante que os ícones sejam renderizados após o HTML ser populado
        if (typeof lucide !== 'undefined') {
            lucide.createIcons();
        } else {
            // Adiciona um pequeno atraso caso o script lucide ainda não tenha carregado
            setTimeout(() => {
                if (typeof lucide !== 'undefined') {
                    lucide.createIcons();
                } else {
                    console.warn('Lucide (ícones) não foi carregado a tempo.');
                }
            }, 500);
        }
    });

    // --- Funções de Inicialização ---

    function initDarkMode() {
        const toggle = document.getElementById('dark-mode-toggle');
        const html = document.documentElement;

        // Verifica preferência do usuário no localStorage ou sistema
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            html.classList.add('dark');
            toggle.setAttribute('aria-pressed', 'true');
        } else {
            html.classList.remove('dark');
            toggle.setAttribute('aria-pressed', 'false');
        }

        // Adiciona evento ao botão de toggle
        toggle.addEventListener('click', () => {
            if (html.classList.contains('dark')) {
                html.classList.remove('dark');
                localStorage.theme = 'light';
                toggle.setAttribute('aria-pressed', 'false');
            } else {
                html.classList.add('dark');
                localStorage.theme = 'dark';
                toggle.setAttribute('aria-pressed', 'true');
            }
        });
    }

    function populateHomePage() {
        const grid = document.getElementById('home-grid');
        grid.innerHTML = ''; // Limpa o grid
        
        for (const [key, category] of Object.entries(libraryData)) {
            const card = `
                <a href="#" data-page="${key}" class="nav-link bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md hover:shadow-lg hover:scale-[1.02] transition-all flex flex-col items-center justify-center text-center">
                    <i data-lucide="${category.icon}" class="w-12 h-12 text-blue-500 dark:text-blue-400 mb-4"></i>
                    <h4 class="text-lg font-semibold mb-1">${category.title}</h4>
                    <span class="text-sm text-gray-500 dark:text-gray-400">${category.files.length} arquivos</span>
                </a>
            `;
            grid.innerHTML += card;
        }
    }

    function populatePdfLists() {
        for (const [key, category] of Object.entries(libraryData)) {
            const list = document.getElementById(`pdf-list-${key}`);
            if (list) {
                list.innerHTML = ''; // Limpa a lista
                if (category.files.length === 0) {
                    list.innerHTML = `<p class="col-span-full text-gray-500 dark:text-gray-400">Nenhum arquivo encontrado nesta seção.</p>`;
                    continue;
                }
                category.files.forEach(file => {
                    list.innerHTML += createPdfCard(file, key);
                });
            }
        }
    }

    function createPdfCard(file, categoryKey) {
        const category = libraryData[categoryKey];
        return `
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden flex flex-col">
                <div class="p-5 flex-1">
                    <div class="flex items-center gap-3 mb-3">
                        <i data-lucide="file-text" class="w-5 h-5 text-blue-500 dark:text-blue-400"></i>
                        <h5 class="text-base font-semibold truncate" title="${file.title}">${file.title}</h5>
                    </div>
                    <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">
                        Matéria: ${category.title}
                    </p>
                </div>
                <div class="p-4 bg-gray-50 dark:bg-gray-700/50 border-t border-gray-200 dark:border-gray-700 flex items-center gap-3">
                    <!-- ALTERAÇÃO: "Ler Agora" agora é um link <a> que abre em nova aba -->
                    <a href="${file.filePath}" target="_blank" class="w-full text-sm bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors flex items-center justify-center gap-2"
                            title="Abrir PDF em nova aba">
                        <i data-lucide="book-open" class="w-4 h-4"></i>
                        Ler Agora
                    </a>
                    <a href="${file.filePath}" download target="_blank" class="p-2 rounded-lg text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600" title="Baixar PDF">
                        <i data-lucide="download" class="w-5 h-5"></i>
                    </a>
                </div>
            </div>
        `;
    }

    function setupEventListeners() {
        const sidebar = document.getElementById('sidebar');
        const menuToggle = document.getElementById('menu-toggle');
        const menuOverlay = document.getElementById('menu-overlay');
        const contentArea = document.getElementById('content-area');
        const searchBar = document.getElementById('search-bar');
        
        // Toggle menu mobile
        const toggleMenu = () => {
            sidebar.classList.toggle('-translate-x-full');
            menuOverlay.classList.toggle('hidden');
        };
        menuToggle.addEventListener('click', toggleMenu);
        menuOverlay.addEventListener('click', toggleMenu);

        // Navegação
        document.body.addEventListener('click', (e) => {
            const navLink = e.target.closest('.nav-link');
            if (navLink) {
                e.preventDefault();
                const page = navLink.dataset.page;
                if (page) {
                    showPage(page);
                    // Fecha o menu mobile ao clicar em um link
                    if (window.innerWidth < 768 && !sidebar.classList.contains('-translate-x-full')) {
                        toggleMenu();
                    }
                }
            }
        });

        // ALTERAÇÃO: Removido o event listener para '.read-pdf-btn'
        // O link <a> agora cuida da abertura do PDF.

        // ALTERAÇÃO: Removidos os listeners para fechar o modal
        
        // Busca
        searchBar.addEventListener('input', (e) => {
            handleSearch(e.target.value);
        });
    }

    // --- Funções Principais ---

    function showPage(pageId) {
        // Esconde todas as páginas
        document.querySelectorAll('.page-content').forEach(page => {
            page.classList.add('hidden');
        });

        // Mostra a página solicitada
        const targetPage = document.getElementById(`page-${pageId}`);
        if (targetPage) {
            targetPage.classList.remove('hidden');
        } else if (pageId !== 'search-results') {
            // Fallback para home se a página não existir
            document.getElementById('page-home').classList.remove('hidden');
            pageId = 'home';
        }

        // Atualiza link ativo na sidebar
        document.querySelectorAll('.nav-link').forEach(link => {
            if (link.dataset.page === pageId) {
                link.classList.add('bg-gray-100', 'dark:bg-gray-700', 'font-semibold');
            } else {
                link.classList.remove('bg-gray-100', 'dark:bg-gray-700', 'font-semibold');
            }
        });

        // Limpa a busca se sair da página de busca
        if (pageId !== 'search-results') {
            document.getElementById('search-bar').value = '';
        }
    }

    // ALTERAÇÃO: Função 'openPdf' removida
    // ALTERAÇÃO: Função 'closePdf' removida

    function handleSearch(query) {
        const searchTerm = query.toLowerCase().trim();
        const resultsList = document.getElementById('search-results-list');
        resultsList.innerHTML = '';
        let resultsFound = 0;

        if (searchTerm.length === 0) {
            showPage('home'); // Volta para home se a busca for limpa
            return;
        }

        for (const [key, category] of Object.entries(libraryData)) {
            category.files.forEach(file => {
                if (file.title.toLowerCase().includes(searchTerm)) {
                    resultsList.innerHTML += createPdfCard(file, key);
                    resultsFound++;
                }
            });
        }

        if (resultsFound === 0) {
            resultsList.innerHTML = `<p class="col-span-full text-gray-500 dark:text-gray-400">Nenhum arquivo encontrado com o termo "${query}".</p>`;
        }

        showPage('search-results');
        
        // Renderiza os ícones dos cards de resultado
        if (typeof lucide !== 'undefined') {
            lucide.createIcons();
        }
    }

    </script>
</body>
</html>

